(window.webpackJsonpproducts_custormManager=window.webpackJsonpproducts_custormManager||[]).push([["custormManager/views/[request]"],{35:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"sysManager-container-index"})};i._withStripped=!0;var s={name:"SysManagerIndex"},n=(a(72),a(54)),r=Object(n.a)(s,i,[],!1,null,"d41291cc",null);r.options.__file="src/products/custormManager/views/index.vue";t.default=r.exports},42:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("basic-handler",[e.addBtnShowFlag&&e.isUpdateAuthWorkFlow?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"small"},on:{click:e.handleAddBtn}},[e._v("新增\n    ")]):e._e(),e._v(" "),e.saveBtnShowFlag?a("el-button",{attrs:{disabled:e.saveBtnDisabledFlag||e.auditBtnDisabledFlag,type:"primary",icon:"el-icon-if-save",size:"small",plain:""},on:{click:e.handleSaveBtn}},[e._v("保存\n    ")]):e._e(),e._v(" "),e.deleteBtnShowFlag&&e.isUpdateAuthWorkFlow?a("el-button",{attrs:{disabled:e.deleteBtnDisabledFlag||!e.detailFormId,type:"danger",icon:"el-icon-delete",size:"small",plain:""},on:{click:e.handleDeleteBtn}},[e._v("删除\n    ")]):e._e(),e._v(" "),e.auditBtnShowFlag&&e.isUpdateAuthWorkFlow?a("el-button",{attrs:{disabled:e.auditBtnDisabledFlag||2!==e.detailForm.validateStatus,type:"primary",icon:"el-icon-if-auth",size:"small",plain:""},on:{click:e.handleAuditBtn}},[e._v("审核\n    ")]):e._e(),e._v(" "),a("basic-see-process",{attrs:{id:e.detailForm.processInstanceId}}),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh",plain:""},on:{click:e.getDetail}},[e._v("刷新")])],1),e._v(" "),a("el-form",{ref:"refDetailForm",staticClass:"form-container",attrs:{model:e.detailForm,rules:e.rules,"show-message":!1,"label-width":"120px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("basic-validate-status",{attrs:{model:e.detailForm}})],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"单据编码"}},[a("el-input",{attrs:{disabled:!0,size:"small",clearable:"",placeholder:"系统自动生成单据编码"},model:{value:e.detailForm.code,callback:function(t){e.$set(e.detailForm,"code",t)},expression:"detailForm.code"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"文件名称",prop:"name","hide-required-asterisk":""}},[a("el-input",{ref:"refName",attrs:{disabled:e.disabledFlag,size:"small",clearable:"",maxlength:"100",placeholder:"请输入文件名称"},model:{value:e.detailForm.name,callback:function(t){e.$set(e.detailForm,"name",t)},expression:"detailForm.name"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户单位",prop:"cusOrgName","hide-required-asterisk":""}},[a("el-input",{attrs:{disabled:e.disabledFlag,size:"small",readonly:"",placeholder:"请选择客户单位"},model:{value:e.detailForm.cusOrgName,callback:function(t){e.$set(e.detailForm,"cusOrgName",t)},expression:"detailForm.cusOrgName"}},[a("el-button",{staticClass:"form-btn",attrs:{slot:"append",disabled:e.disabledFlag,size:"small",icon:"el-icon-plus"},on:{click:function(t){e.toipClick("unit")}},slot:"append"})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"签字人员"}},[a("el-input",{attrs:{disabled:e.disabledFlag,size:"small",clearable:"",maxlength:"100",placeholder:"请输入签字人员"},model:{value:e.detailForm.signaturePerson,callback:function(t){e.$set(e.detailForm,"signaturePerson",t)},expression:"detailForm.signaturePerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"实施人员",prop:"impPerson"}},[a("el-input",{ref:"refImpPerson",attrs:{disabled:e.disabledFlag,size:"small",clearable:"",maxlength:"100",placeholder:"请输入实施人员"},model:{value:e.detailForm.impPerson,callback:function(t){e.$set(e.detailForm,"impPerson",t)},expression:"detailForm.impPerson"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"业务日期",prop:"signDate"}},[a("el-date-picker",{attrs:{editable:!1,clearable:!1,disabled:e.disabledFlag,size:"small",type:"date",format:"yyyy-MM-dd","value-format":"timestamp",placeholder:"选择日期"},model:{value:e.detailForm.signDate,callback:function(t){e.$set(e.detailForm,"signDate",t)},expression:"detailForm.signDate"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注说明"}},[a("el-input",{attrs:{disabled:e.disabledFlag,autosize:{minRows:6,maxRows:8},maxlength:5e3,size:"small",clearable:"",type:"textarea",placeholder:"请输入备注说明，不超过5000字"},model:{value:e.detailForm.remark,callback:function(t){e.$set(e.detailForm,"remark",t)},expression:"detailForm.remark"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"add-border file",attrs:{label:"附件"}},[a("basic-upload",{ref:"refBasicUpload",attrs:{disabled:e.disabledFlag,"form-id":e.detailFormId}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"登记人员"}},[a("el-input",{attrs:{disabled:!0,size:"small",clearable:"",placeholder:"系统自动生成登记人员"},model:{value:e.detailForm.inputPerson,callback:function(t){e.$set(e.detailForm,"inputPerson",t)},expression:"detailForm.inputPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"登记时间"}},[a("el-input",{attrs:{disabled:!0,size:"small",clearable:"",placeholder:"系统自动生成登记时间"},model:{value:e.detailForm.inputTime,callback:function(t){e.$set(e.detailForm,"inputTime",t)},expression:"detailForm.inputTime"}})],1)],1)],1)],1),e._v(" "),a("basic-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{visible:e.visibleSyncUnit,title:"产品使用单位-选择"},on:{"update:visible":function(t){e.visibleSyncUnit=t}}},[e.visibleSyncUnit?a("dialog-unit",{on:{selectionChange:e.selectionChange}}):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visibleSyncUnit=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleChange}},[e._v("确 定")])],1)],1)],1)};i._withStripped=!0;var s=a(62),n=a.n(s),r=a(63),l=a.n(r),o=a(5),d=a.n(o),c=a(55),u=a(56),m=a(57),p=a(59),f=a(33),g=a(60),h=a(34);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var F={name:"ResultsFileDetail",components:{dialogUnit:function(){return a.e("custormManager/null").then(a.bind(null,84))}},mixins:[c.a,u.a,m.a,p.a],props:{isUpdateAuthWorkFlow:{type:Boolean,default:function(){return!0}},reserve:null},data:function(){return{addBtnShowFlag:!0,saveBtnShowFlag:!0,deleteBtnShowFlag:!0,auditBtnShowFlag:!0,saveBtnDisabledFlag:!0,detailForm:{},detailFormId:void 0,rules:{name:[{required:!0,message:"请输入单据名称",trigger:"change"}],cusOrgName:[{required:!0,message:"请选择客户单位",trigger:"change"}],impPerson:[{required:!0,validator:function(e,t,a){Object(g.c)(e,t,a,!0,["实施人员",1,100])},trigger:"change"}],signDate:[{required:!0,message:"请输入业务日期",trigger:"change"}]},apiParams:{productAlias:"smartpm",pageCode:"sysBusResult"},type:null,visibleSyncUnit:!1,selectedRow:{}}},computed:{deleteBtnDisabledFlag:function(){return!!this.$utils.isEmpty(this.detailForm)||2!==this.detailForm.validateStatus},auditBtnDisabledFlag:function(){if(this.validateStatus)return 1!=this.reserve&&this.validateStatus.map((function(e){return Number(e.code)})).includes(this.detailForm.validateStatus)},validateStatus:function(){return Array.isArray(this.dataEnum.auditStatusEnum)?this.dataEnum.auditStatusEnum.filter((function(e){return 1==e.code||3==e.code||4==e.code||5==e.code})):{}},disabledFlag:function(){return this.auditBtnDisabledFlag}},watch:{detailForm:{handler:function(){this.saveBtnDisabledFlag=!1},deep:!0}},deactivated:function(){this.$store.dispatch("cacheId",void 0)},activated:function(){var e=this;this.$utilsBasic.loadAddAndDetailData(this,(function(){e.$route.params&&(e.detailFormId=e.$route.params.id?e.$route.params.id:void 0),e.$route.query&&(e.detailForm.cusOrgId=e.$route.query.id?e.$route.query.id:void 0,e.detailForm.cusOrgName=e.$route.query.name?e.$route.query.name:void 0),e.handleAddBtn()}),(function(t){e.detailFormId=t,e.getDetail()}))},created:function(){this.getEnumData(["GetValidateStatusData"]),this.$store.dispatch("cacheId","0")},methods:{handleAddBtn:function(){this.addDetail()},handleSaveBtn:function(){var e=this;this.validateAfter((function(){e.saveDetailForm().catch((function(e){console.log(e)}))}))},handleDeleteBtn:function(){var e=this;this.$confirm(f.a.info.delete,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$utils.isEmpty(e.detailFormId)?(e.$set(e.detailForm,"cusOrgId",""),e.$set(e.detailForm,"cusOrgName",""),e.addDetail()):e.deleteDetailForm().then((function(){e.$set(e.detailForm,"cusOrgId",""),e.$set(e.detailForm,"cusOrgName",""),e.addDetail()})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},handleAuditBtn:function(){var e=this;this.validateAfter((function(){e.$confirm(f.a.info.audit,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.saveDetailForm(!0).then((function(){e.auditDetailForm()})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}))},addDetail:function(){var e=this;this.$nextTick((function(){e.detailFormId=void 0,e.detailForm={id:"",validateStatus:2,cusOrgId:e.detailForm.cusOrgId,cusOrgName:e.detailForm.cusOrgName,name:"",signDate:(new Date).getTime(),inputPerson:e.userLogin.inputPersonFullPath,inputTime:e.$utils.date.format(new Date,"YYYY-MM-DD hh:mm:ss")},e.$refs.refDetailForm.resetFields(),e.$refs.refName.focus(),console.log("this.detailForm",e.detailForm)}))},saveDetailForm:function(e){var t=this,a=this.$utils.copy(this.detailForm);return this.$utils.isEmpty(this.detailFormId)?h.a.static.postObj(b({},this.apiParams,{field:a})).then(function(){var a=l()(n.a.mark((function a(i){return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!i.status||200!==i.status){a.next=12;break}return console.log("保存成功",i),t.detailForm.id=i.data.id,t.detailFormId=i.data.id,t.detailForm=Object.assign({},i.data,{signDate:i.data.signDate?new Date(i.data.signDate).getTime():""}),a.next=7,t.$refs.refBasicUpload.submitUpload(i.data);case 7:if(a.sent){a.next=9;break}return a.abrupt("return",!1);case 9:e||t.$message.success(i.message),a.next=13;break;case 12:t.$message({message:i.message,type:"warning"});case 13:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){console.log(e)})):h.a.static.putObj(b({},this.apiParams,{field:a})).then(function(){var a=l()(n.a.mark((function a(i){return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!i.status||200!==i.status){a.next=10;break}return t.detailForm=Object.assign({},i.data,{signDate:i.data.signDate?new Date(i.data.signDate).getTime():""}),console.log("修改成功",i),a.next=5,t.$refs.refBasicUpload.submitUpload(i.data);case 5:if(a.sent){a.next=7;break}return a.abrupt("return",!1);case 7:e||t.$message.success(i.message),a.next=11;break;case 10:t.$message({message:i.message,type:"warning"});case 11:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},validateAfter:function(e){var t=!0;if(this.$refs.refDetailForm.validate((function(e){return!e&&(t=e),!t})),!t)return this.$message({message:f.a.info.updateEmptyError,type:"warning"}),this.$utilsBasic.valideFocus(this,["refName","refImpPerson"]);"function"==typeof e&&e()},deleteDetailForm:function(){var e=this;return h.a.static.deleteObj(b({},this.apiParams,{field:{id:this.detailFormId}})).then((function(t){t.status&&200===t.status?(e.$message.success(t.message),e.$refs.refBasicUpload.clearAttacheFile()):e.$message({message:t.message,type:"warning"})})).catch((function(e){console.log(e)}))},auditDetailForm:function(){var e=this;return console.log("this.detailForm",this.detailForm),h.a.static.putObjAudit(b({},this.apiParams,{field:this.detailForm})).then((function(t){if(console.log("audit res",t),t.status&&200===t.status){if(e.detailForm=Object.assign({},t.data,{signDate:t.data.signDate?new Date(t.data.signDate).getTime():""}),t.data.processInstanceId)return e.$store.dispatch("OpenSelectUserAndHandleAudit",{processId:t.data.processInstanceId,formData:t.data}).then((function(){e.$message.success(t.message)}));e.$message.success(t.message)}else e.$message({message:t.message,type:"warning"})})).catch((function(e){console.log(e)}))},getDetail:function(){var e=this;if(!this.$utils.isEmpty(this.detailFormId))return h.a.static.getObjDetail(b({},this.apiParams,{field:{id:this.detailFormId}})).then((function(t){t.status&&200===t.status?(console.log("get detailForm",t),e.detailForm=Object.assign({},t.data,{signDate:t.data.signDate?new Date(t.data.signDate).getTime():""})):e.$message({message:t.message,type:"warning"})})).catch((function(e){console.log(e)}));this.addDetail()},toipClick:function(e){this.disabled||(this.type=e,this["visibleSync"+e.replace(/(^[\w\W])/,(function(e){return e.toLocaleUpperCase()}))]=!0)},selectionChange:function(e){console.log("回传row",e),this.selectedRow=e.selectedRow},handleChange:function(){var e=this.selectedRow;if(!this.isSelectedRow(e))return!1;if(0!==Object.keys(e).length){switch(this.type){case"unit":this.detailForm.cusOrgId!==e.id&&(this.detailForm=Object.assign({},this.detailForm,{cusOrgName:e.name,cusOrgId:e.id}))}this.saveBtnDisabledFlag=!1,this["visibleSync"+this.type.replace(/(^[\w\W])/,(function(e){return e.toLocaleUpperCase()}))]=!1}}}},y=a(54),D=Object(y.a)(F,i,[],!1,null,null,null);D.options.__file="src/products/custormManager/views/sysInfo/businessManager/resultsFile/detail.vue";t.default=D.exports},43:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("basic-handler",[e.addBtnShowFlag&&e.isUpdateAuthWorkFlow?a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"small"},on:{click:e.handleAddBtn}},[e._v("新增\n    ")]):e._e(),e._v(" "),e.saveBtnShowFlag?a("el-button",{attrs:{disabled:e.saveBtnDisabledFlag||e.auditBtnDisabledFlag,type:"primary",icon:"el-icon-if-save",size:"small",plain:""},on:{click:e.handleSaveBtn}},[e._v("保存\n    ")]):e._e(),e._v(" "),e.deleteBtnShowFlag&&e.isUpdateAuthWorkFlow?a("el-button",{attrs:{disabled:e.deleteBtnDisabledFlag||!e.detailFormId,type:"danger",icon:"el-icon-delete",size:"small",plain:""},on:{click:e.handleDeleteBtn}},[e._v("删除\n    ")]):e._e(),e._v(" "),e.auditBtnShowFlag&&e.isUpdateAuthWorkFlow?a("el-button",{attrs:{disabled:e.auditBtnDisabledFlag||2!==e.detailForm.validateStatus,type:"primary",icon:"el-icon-if-auth",size:"small",plain:""},on:{click:e.handleAuditBtn}},[e._v("审核\n    ")]):e._e(),e._v(" "),a("basic-see-process",{attrs:{id:e.detailForm.processInstanceId}}),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh",plain:""},on:{click:e.getDetail}},[e._v("刷新")])],1),e._v(" "),a("el-form",{ref:"refDetailForm",staticClass:"form-container",attrs:{model:e.detailForm,rules:e.rules,"show-message":!1,"label-width":"120px"}},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("basic-validate-status",{attrs:{model:e.detailForm}})],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"单据编码"}},[a("el-input",{attrs:{disabled:!0,size:"small",clearable:"",placeholder:"系统自动生成单据编码"},model:{value:e.detailForm.code,callback:function(t){e.$set(e.detailForm,"code",t)},expression:"detailForm.code"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"服务名称",prop:"name","hide-required-asterisk":""}},[a("el-input",{ref:"refName",attrs:{disabled:e.disabledFlag,size:"small",clearable:"",maxlength:"100",placeholder:"请输入服务名称"},model:{value:e.detailForm.name,callback:function(t){e.$set(e.detailForm,"name",t)},expression:"detailForm.name"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"客户单位",prop:"cusOrgName","hide-required-asterisk":""}},[a("el-input",{attrs:{disabled:e.disabledFlag,size:"small",readonly:"",placeholder:"请选择客户单位"},model:{value:e.detailForm.cusOrgName,callback:function(t){e.$set(e.detailForm,"cusOrgName",t)},expression:"detailForm.cusOrgName"}},[a("el-button",{staticClass:"form-btn",attrs:{slot:"append",disabled:e.disabledFlag,size:"small",icon:"el-icon-plus"},on:{click:function(t){e.toipClick("unit")}},slot:"append"})],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"签字人员"}},[a("el-input",{attrs:{disabled:e.disabledFlag,size:"small",clearable:"",maxlength:"100",placeholder:"请输入签字人员"},model:{value:e.detailForm.signaturePerson,callback:function(t){e.$set(e.detailForm,"signaturePerson",t)},expression:"detailForm.signaturePerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"服务人员",prop:"servicePerson"}},[a("el-input",{ref:"refImpPerson",attrs:{disabled:e.disabledFlag,size:"small",clearable:"",maxlength:"100",placeholder:"请输入实施人员"},model:{value:e.detailForm.servicePerson,callback:function(t){e.$set(e.detailForm,"servicePerson",t)},expression:"detailForm.servicePerson"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"服务日期"}},[a("el-date-picker",{attrs:{editable:!1,clearable:!1,disabled:e.disabledFlag,size:"small",type:"date",format:"yyyy-MM-dd","value-format":"timestamp",placeholder:"选择日期"},model:{value:e.detailForm.signDate,callback:function(t){e.$set(e.detailForm,"signDate",t)},expression:"detailForm.signDate"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"备注说明"}},[a("el-input",{attrs:{disabled:e.disabledFlag,autosize:{minRows:6,maxRows:8},maxlength:5e3,size:"small",clearable:"",type:"textarea",placeholder:"请输入备注说明，不超过5000字"},model:{value:e.detailForm.remark,callback:function(t){e.$set(e.detailForm,"remark",t)},expression:"detailForm.remark"}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{staticClass:"add-border file",attrs:{label:"附件"}},[a("basic-upload",{ref:"refBasicUpload",attrs:{disabled:e.disabledFlag,"form-id":e.detailFormId}})],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:16}},[a("el-form-item",{attrs:{label:"登记人员"}},[a("el-input",{attrs:{disabled:!0,size:"small",clearable:"",placeholder:"系统自动生成登记人员"},model:{value:e.detailForm.inputPerson,callback:function(t){e.$set(e.detailForm,"inputPerson",t)},expression:"detailForm.inputPerson"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"登记时间"}},[a("el-input",{attrs:{disabled:!0,size:"small",clearable:"",placeholder:"系统自动生成登记时间"},model:{value:e.detailForm.inputTime,callback:function(t){e.$set(e.detailForm,"inputTime",t)},expression:"detailForm.inputTime"}})],1)],1)],1)],1),e._v(" "),a("basic-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{visible:e.visibleSyncUnit,title:"产品使用单位-选择"},on:{"update:visible":function(t){e.visibleSyncUnit=t}}},[e.visibleSyncUnit?a("dialog-unit",{on:{selectionChange:e.selectionChange}}):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visibleSyncUnit=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.handleChange}},[e._v("确 定")])],1)],1)],1)};i._withStripped=!0;var s=a(62),n=a.n(s),r=a(63),l=a.n(r),o=a(5),d=a.n(o),c=a(55),u=a(56),m=a(57),p=a(59),f=a(33),g=a(60),h=a(34);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){d()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var F={name:"ServiceLogDetail",components:{dialogUnit:function(){return a.e("custormManager/null").then(a.bind(null,84))}},mixins:[c.a,u.a,m.a,p.a],props:{isUpdateAuthWorkFlow:{type:Boolean,default:function(){return!0}},reserve:null},data:function(){return{addBtnShowFlag:!0,saveBtnShowFlag:!0,deleteBtnShowFlag:!0,auditBtnShowFlag:!0,saveBtnDisabledFlag:!0,detailForm:{},detailFormId:void 0,rules:{name:[{required:!0,message:"请输入服务名称",trigger:"change"}],cusOrgName:[{required:!0,message:"请选择客户单位",trigger:"change"}],servicePerson:[{required:!0,validator:function(e,t,a){Object(g.c)(e,t,a,!0,["服务人员",1,100])},trigger:"change"}]},apiParams:{productAlias:"smartpm",pageCode:"sysBusServiceRecord"},type:null,visibleSyncUnit:!1,selectedRow:{}}},computed:{deleteBtnDisabledFlag:function(){return!!this.$utils.isEmpty(this.detailForm)||2!==this.detailForm.validateStatus},auditBtnDisabledFlag:function(){if(this.validateStatus)return 1!=this.reserve&&this.validateStatus.map((function(e){return Number(e.code)})).includes(this.detailForm.validateStatus)},validateStatus:function(){return Array.isArray(this.dataEnum.auditStatusEnum)?this.dataEnum.auditStatusEnum.filter((function(e){return 1==e.code||3==e.code||4==e.code||5==e.code})):{}},disabledFlag:function(){return this.auditBtnDisabledFlag}},watch:{detailForm:{handler:function(){this.saveBtnDisabledFlag=!1},deep:!0}},deactivated:function(){this.$store.dispatch("cacheId",void 0)},activated:function(){var e=this;this.$utilsBasic.loadAddAndDetailData(this,(function(){e.$route.params&&(e.detailFormId=e.$route.params.id?e.$route.params.id:void 0),e.$route.query&&(e.detailForm.cusOrgId=e.$route.query.id?e.$route.query.id:void 0,e.detailForm.cusOrgName=e.$route.query.name?e.$route.query.name:void 0),e.handleAddBtn()}),(function(t){e.detailFormId=t,e.getDetail()}))},created:function(){this.getEnumData(["GetValidateStatusData"]),this.$store.dispatch("cacheId","0")},methods:{handleAddBtn:function(){this.addDetail()},handleSaveBtn:function(){var e=this;this.validateAfter((function(){e.saveDetailForm().catch((function(e){console.log(e)}))}))},handleDeleteBtn:function(){var e=this;this.$confirm(f.a.info.delete,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$utils.isEmpty(e.detailFormId)?(e.$set(e.detailForm,"cusOrgId",""),e.$set(e.detailForm,"cusOrgName",""),e.addDetail()):e.deleteDetailForm().then((function(){e.$set(e.detailForm,"cusOrgId",""),e.$set(e.detailForm,"cusOrgName",""),e.addDetail()})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},handleAuditBtn:function(){var e=this;this.validateAfter((function(){e.$confirm(f.a.info.audit,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.saveDetailForm(!0).then((function(){e.auditDetailForm()})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))}))},addDetail:function(){var e=this;this.$nextTick((function(){e.detailFormId=void 0,e.detailForm={id:"",validateStatus:2,cusOrgId:e.detailForm.cusOrgId,cusOrgName:e.detailForm.cusOrgName,name:"",signDate:(new Date).getTime(),inputPerson:e.userLogin.inputPersonFullPath,inputTime:e.$utils.date.format(new Date,"YYYY-MM-DD hh:mm:ss")},e.$refs.refDetailForm.resetFields(),e.$refs.refName.focus(),console.log("this.detailForm",e.detailForm)}))},saveDetailForm:function(e){var t=this,a=this.$utils.copy(this.detailForm);return this.$utils.isEmpty(this.detailFormId)?h.a.static.postObj(b({},this.apiParams,{field:a})).then(function(){var a=l()(n.a.mark((function a(i){return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!i.status||200!==i.status){a.next=12;break}return console.log("保存成功",i),t.detailForm.id=i.data.id,t.detailFormId=i.data.id,t.detailForm=Object.assign({},i.data,{signDate:i.data.signDate?new Date(i.data.signDate).getTime():""}),a.next=7,t.$refs.refBasicUpload.submitUpload(i.data);case 7:if(a.sent){a.next=9;break}return a.abrupt("return",!1);case 9:e||t.$message.success(i.message),a.next=13;break;case 12:t.$message({message:i.message,type:"warning"});case 13:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){console.log(e)})):h.a.static.putObj(b({},this.apiParams,{field:a})).then(function(){var a=l()(n.a.mark((function a(i){return n.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!i.status||200!==i.status){a.next=10;break}return t.detailForm=Object.assign({},i.data,{signDate:i.data.signDate?new Date(i.data.signDate).getTime():""}),console.log("修改成功",i),a.next=5,t.$refs.refBasicUpload.submitUpload(i.data);case 5:if(a.sent){a.next=7;break}return a.abrupt("return",!1);case 7:e||t.$message.success(i.message),a.next=11;break;case 10:t.$message({message:i.message,type:"warning"});case 11:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},validateAfter:function(e){var t=!0;if(this.$refs.refDetailForm.validate((function(e){return!e&&(t=e),!t})),!t)return this.$message({message:f.a.info.updateEmptyError,type:"warning"}),this.$utilsBasic.valideFocus(this,["refName","refImpPerson"]);"function"==typeof e&&e()},deleteDetailForm:function(){var e=this;return h.a.static.deleteObj(b({},this.apiParams,{field:{id:this.detailFormId}})).then((function(t){t.status&&200===t.status?(e.$message.success(t.message),e.$refs.refBasicUpload.clearAttacheFile()):e.$message({message:t.message,type:"warning"})})).catch((function(e){console.log(e)}))},auditDetailForm:function(){var e=this;return console.log("this.detailForm",this.detailForm),h.a.static.putObjAudit(b({},this.apiParams,{field:this.detailForm})).then((function(t){if(console.log("audit res",t),t.status&&200===t.status){if(e.detailForm=Object.assign({},t.data,{signDate:t.data.signDate?new Date(t.data.signDate).getTime():""}),t.data.processInstanceId)return e.$store.dispatch("OpenSelectUserAndHandleAudit",{processId:t.data.processInstanceId,formData:t.data}).then((function(){e.$message.success(t.message)}));e.$message.success(t.message)}else e.$message({message:t.message,type:"warning"})})).catch((function(e){console.log(e)}))},getDetail:function(){var e=this;if(!this.$utils.isEmpty(this.detailFormId))return h.a.static.getObjDetail(b({},this.apiParams,{field:{id:this.detailFormId}})).then((function(t){t.status&&200===t.status?(console.log("get detailForm",t),e.detailForm=Object.assign({},t.data,{signDate:t.data.signDate?new Date(t.data.signDate).getTime():""})):e.$message({message:t.message,type:"warning"})})).catch((function(e){console.log(e)}));this.addDetail()},toipClick:function(e){this.disabled||(this.type=e,this["visibleSync"+e.replace(/(^[\w\W])/,(function(e){return e.toLocaleUpperCase()}))]=!0)},selectionChange:function(e){console.log("回传row",e),this.selectedRow=e.selectedRow},handleChange:function(){var e=this.selectedRow;if(!this.isSelectedRow(e))return!1;if(0!==Object.keys(e).length){switch(this.type){case"unit":this.detailForm.cusOrgId!==e.id&&(this.detailForm=Object.assign({},this.detailForm,{cusOrgName:e.name,cusOrgId:e.id}))}this.saveBtnDisabledFlag=!1,this["visibleSync"+this.type.replace(/(^[\w\W])/,(function(e){return e.toLocaleUpperCase()}))]=!1}}}},y=a(54),D=Object(y.a)(F,i,[],!1,null,null,null);D.options.__file="src/products/custormManager/views/sysInfo/businessManager/serviceLog/detail.vue";t.default=D.exports},64:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a=e[1]||"",i=e[3];if(!i)return a;if(t&&"function"==typeof btoa){var s=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),n=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[a].concat(n).concat([s]).join("\n")}var r;return[a].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+a+"}":a})).join("")},t.i=function(e,a){"string"==typeof e&&(e=[[null,e,""]]);for(var i={},s=0;s<this.length;s++){var n=this[s][0];null!=n&&(i[n]=!0)}for(s=0;s<e.length;s++){var r=e[s];null!=r[0]&&i[r[0]]||(a&&!r[2]?r[2]=a:a&&(r[2]="("+r[2]+") and ("+a+")"),t.push(r))}},t}},65:function(e,t,a){"use strict";function i(e,t){for(var a=[],i={},s=0;s<t.length;s++){var n=t[s],r=n[0],l={id:e+":"+s,css:n[1],media:n[2],sourceMap:n[3]};i[r]?i[r].parts.push(l):a.push(i[r]={id:r,parts:[l]})}return a}a.r(t),a.d(t,"default",(function(){return p}));var s="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!s)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var n={},r=s&&(document.head||document.getElementsByTagName("head")[0]),l=null,o=0,d=!1,c=function(){},u=null,m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,a,s){d=a,u=s||{};var r=i(e,t);return f(r),function(t){for(var a=[],s=0;s<r.length;s++){var l=r[s];(o=n[l.id]).refs--,a.push(o)}t?f(r=i(e,t)):r=[];for(s=0;s<a.length;s++){var o;if(0===(o=a[s]).refs){for(var d=0;d<o.parts.length;d++)o.parts[d]();delete n[o.id]}}}}function f(e){for(var t=0;t<e.length;t++){var a=e[t],i=n[a.id];if(i){i.refs++;for(var s=0;s<i.parts.length;s++)i.parts[s](a.parts[s]);for(;s<a.parts.length;s++)i.parts.push(h(a.parts[s]));i.parts.length>a.parts.length&&(i.parts.length=a.parts.length)}else{var r=[];for(s=0;s<a.parts.length;s++)r.push(h(a.parts[s]));n[a.id]={id:a.id,refs:1,parts:r}}}}function g(){var e=document.createElement("style");return e.type="text/css",r.appendChild(e),e}function h(e){var t,a,i=document.querySelector('style[data-vue-ssr-id~="'+e.id+'"]');if(i){if(d)return c;i.parentNode.removeChild(i)}if(m){var s=o++;i=l||(l=g()),t=F.bind(null,i,s,!1),a=F.bind(null,i,s,!0)}else i=g(),t=y.bind(null,i),a=function(){i.parentNode.removeChild(i)};return t(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;t(e=i)}else a()}}var v,b=(v=[],function(e,t){return v[e]=t,v.filter(Boolean).join("\n")});function F(e,t,a,i){var s=a?"":i.css;if(e.styleSheet)e.styleSheet.cssText=b(t,s);else{var n=document.createTextNode(s),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(n,r[t]):e.appendChild(n)}}function y(e,t){var a=t.css,i=t.media,s=t.sourceMap;if(i&&e.setAttribute("media",i),u.ssrId&&e.setAttribute("data-vue-ssr-id",t.id),s&&(a+="\n/*# sourceURL="+s.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}},71:function(e,t,a){var i=a(73);"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,a(65).default)("67952fec",i,!1,{})},72:function(e,t,a){"use strict";var i=a(71);a.n(i).a},73:function(e,t,a){t=e.exports=a(64)(!1);var i=a(74)(a(75));t.push([e.i,".sysManager-container-index[data-v-d41291cc]{height:100%;background:url("+i+") no-repeat;background-size:100% 100%}\n",""])},74:function(e,t,a){"use strict";e.exports=function(e,t){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)||t?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},75:function(e,t,a){e.exports=a.p+"img/a11fb37245988ce078ed82248fd444bf.jpg"}}]);