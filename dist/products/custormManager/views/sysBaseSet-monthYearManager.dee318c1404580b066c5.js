(window.webpackJsonpproducts_custormManager=window.webpackJsonpproducts_custormManager||[]).push([["custormManager/views/sysBaseSet-monthYearManager"],{20:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this.$createElement,t=this._self._c||e;return t("basic-split-pane",{staticClass:"monthYearManager-container-index"},[t("template",{slot:"leftContainer"},[t("year-plate")],1),this._v(" "),t("template",{slot:"rightContainer"},[t("monthPlate")],1)],2)};n._withStripped=!0;var r=a(42),s=a(41),i={components:{monthPlate:r.default,yearPlate:s.default}},c=a(54),o=Object(c.a)(i,n,[],!1,null,null,null);o.options.__file="src/products/custormManager/views/sysBaseSet/monthYearManager/index.vue";t.default=o.exports},41:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"right-container"},[a("basic-handler",[e.AddBtnShowFlag?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus",plain:""},on:{click:e.clickYearAdd}},[e._v("新增\n    ")]):e._e(),e._v(" "),e.saveBtnShowFlag?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-if-save",plain:""},on:{click:e.clickYearSave}},[e._v("\n      保存\n    ")]):e._e(),e._v(" "),e.deleteBtnShowFlag?a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",plain:""},on:{click:e.clickYearDelete}},[e._v("删除\n    ")]):e._e(),e._v(" "),e.auditBtnShowFlag?a("el-button",{attrs:{disabled:e.auditBtnDisabledFlag,"delete-btn-disabled-flag":"",type:"primary",size:"small",icon:"el-icon-if-auth",plain:""},on:{click:e.clickYearAudit}},[e._v("审核\n    ")]):e._e(),e._v(" "),e.disabledBtnShowFlag?a("el-button",{attrs:{disabled:e.disabledBtnDisableFlag,size:"small",type:"danger",icon:"el-icon-circle-close",plain:""},on:{click:e.clickDisabledBtn}},[e._v("禁用\n    ")]):e._e(),e._v(" "),e.enabledBtnShowFlag?a("el-button",{attrs:{disabled:e.enabledBtnDisableFlag,size:"small",type:"success",icon:"el-icon-circle-check",plain:""},on:{click:e.clickEnabledBtn}},[e._v("启用\n    ")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh",plain:""},on:{click:function(t){e.getYearlist()}}},[e._v("刷新")])],1),e._v(" "),a("basic-table",{ref:"refYearTable",attrs:{"data-table":e.dataYear,columns:e.columns,pagination:e.modelSearchFilterYear},on:{"current-change":e.currentChangeRow,pagination:e.getYearlist},scopedSlots:e._u([{key:"validateStatus",fn:function(t){return[e._v("\n      "+e._s(e.formatValidateStatus(t.scope.row))+"\n    ")]}},{key:"enable",fn:function(t){return[e._v("\n      "+e._s(e.formatEnable(t.scope.row))+"\n    ")]}},{key:"year",fn:function(t){return[a("el-form",{ref:"formYear"+t.scope.$index,attrs:{model:e.dataYear.data[t.scope.$index],rules:e.rules,"show-message":!1}},[a("el-form-item",{attrs:{prop:"year"}},[a("el-input",{attrs:{size:"small",type:"number",placeholder:"请输入会计年度，4位数字"},on:{change:function(a){e.changeRow(t.scope.row)}},model:{value:t.scope.row.year,callback:function(a){e.$set(t.scope.row,"year",a)},expression:"obj.scope.row.year"}})],1)],1)]}},{key:"reserve",fn:function(t){return[a("el-input",{attrs:{clearable:"",size:"small",placeholder:"请输入补充说明"},on:{change:function(a){e.changeRow(t.scope.row)}},model:{value:t.scope.row.reserve,callback:function(a){e.$set(t.scope.row,"reserve",a)},expression:"obj.scope.row.reserve"}})]}}])})],1)};n._withStripped=!0;var r=a(55),s=a(56),i=a(7),c=a(60),o=a(58),l=a(33),u={name:"YearManager",mixins:[r.a,s.a,o.a],data:function(){return{AddBtnShowFlag:!0,saveBtnShowFlag:!0,deleteBtnShowFlag:!0,auditBtnShowFlag:!0,disabledBtnShowFlag:!0,enabledBtnShowFlag:!0,dataYear:{data:[],total:0},listIdYear:0,currentRow:void 0,yearChangedArray:[],rules:{year:[{required:!0,validator:function(e,t,a){Object(c.c)(e,t,a,!0,["会计年度",4,4])},trigger:"change"}]},yearNum:"",modelSearchFilterYear:{page:1,limit:10},columns:[{text:"审核状态",value:"validateStatus",width:"80",align:"center"},{text:"启用状态",value:"enable",width:"80",align:"center"},{text:"会计年度",value:"year",minWidth:100,align:"left",headerAlign:"center",className:"spacing-set"},{text:"补充说明",value:"reserve",minWidth:140,align:"left",headerAlign:"center",className:"spacing-set"}]}},computed:{deleteBtnDisabledFlag:function(){return!this.currentRow||1!=this.currentRow.enable||1==this.currentRow.validateStatus},auditBtnDisabledFlag:function(){return!this.currentRow||""==this.currentRow.validateStatus||1==this.currentRow.validateStatus},disabledBtnDisableFlag:function(){return!this.currentRow||1!==this.currentRow.validateStatus||2===this.currentRow.enable},enabledBtnDisableFlag:function(){return!this.currentRow||1!==this.currentRow.validateStatus||1===this.currentRow.enable}},mounted:function(){this.getEnumData(["GetValidateStatusData","GetEnabledData"]),this.getYearlist()},methods:{clickYearAdd:function(){var e=this;function t(){var e={enable:1,validateStatus:2,listId:this.listIdYear++};this.dataYear.data.unshift(e),this.yearChangedArray.unshift(e),this.$refs.refYearTable.setCurrentRow(this.dataYear.data[0])}1==this.modelSearchFilterYear.page?t.call(this):this.getYearlist((function(){e.modelSearchFilterYear.page=1,t.call(e)}))},changeRow:function(e){e&&(this.$set(e,"listId",this.listIdYear++),this.yearChangedArray.push(e))},clickYearSave:function(){var e=this;return this.validateAfter((function(){var t=Object(i.a)(e.yearChangedArray);t&&t.length>0?e.addYearList(t):e.$message({message:l.a.info.updateEmpty,type:"warning"})}))},validateAfter:function(e){var t=this,a=!0;if(this.dataYear.data.some((function(e,n){return t.$refs["formYear"+n].validate((function(e){!e&&(a=e)})),!a})),!a)return this.$message({message:l.a.info.updateEmptyError,type:"warning"}),!1;"function"==typeof e&&e()},addYearList:function(e){var t=this;this.$store.dispatch("AddAccountancyYear",e).then((function(e){200===e.status?(t.getYearlist(),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"warning"})})).catch((function(e){console.log(e)}))},clickYearDelete:function(){var e=this;this.$confirm(l.a.info.delete,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.currentRow.id?e.$store.dispatch("DeleteAccountancyYear",e.currentRow.id).then((function(t){200===t.status?(e.$message({message:t.message,type:"success"}),e.getYearlist()):e.$message({message:t.message,type:"warning"})})).catch((function(e){console.log(e)})):e.getYearlist()})).catch((function(e){}))},currentChangeRow:function(e){e&&(this.currentRow=e)},clickYearAudit:function(){var e=this;return this.validateAfter((function(){var t=e.currentRow;e.$confirm(l.a.info.audit,"提示",{distinguishCancelAndClose:!0,confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){var a=Object(i.a)(e.yearChangedArray);a&&a.length>0?e.$store.dispatch("AddAccountancyYear",a).then((function(t){e.$utils.isEmpty(t.data)||e.$utilsBasic.getCurrentRowByListId(t.data,e.currentRow,(function(t){return e.auditYear(t),!0}))})).catch((function(e){console.log(e)})):e.auditYear(t)})).catch((function(e){console.log(e)}))}))},auditYear:function(e){var t=this;return this.$store.dispatch("ConfigAccountancyYear",e).then((function(e){200===e.status?(t.getYearlist(),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"warning"})}))},clickEnabledBtn:function(){var e=this;this.$confirm(l.a.info.enable,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.enableOrDisableYear(1).then((function(){}))})).catch((function(e){console.log(e)}))},clickDisabledBtn:function(){var e=this;this.$confirm(l.a.info.disEnable,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.enableOrDisableYear(2).then((function(){}))})).catch((function(e){console.log(e)}))},enableOrDisableYear:function(e){var t=this,a=Object(i.b)(this.currentRow);return a.enable=e,this.$store.dispatch("EnableOrDisabledYear",a).then((function(a){200===a.status?(t.currentRow.enable=e,t.$message({message:a.message,type:"success"})):t.$message({message:a.message,type:"warning"})}))},getYearlist:function(e){var t=this;this.$store.dispatch("GetAccountancyYear",this.modelSearchFilterYear).then((function(a){t.dataYear.data=a.data.rows,t.dataYear.total=a.data.total,t.$nextTick((function(){this.$refs.refYearTable&&this.$refs.refYearTable.setCurrentRow(this.dataYear.data[0])})),t.resetData(),"function"==typeof e&&e()})).catch((function(e){console.log(e)}))},resetData:function(){this.yearChangedArray=[],this.currentRow=void 0}}},d=a(54),h=Object(d.a)(u,n,[],!1,null,null,null);h.options.__file="src/products/custormManager/views/sysBaseSet/monthYearManager/year.vue";t.default=h.exports}}]);