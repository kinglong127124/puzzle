(window.webpackJsonpproducts_sysManager=window.webpackJsonpproducts_sysManager||[]).push([["sysManager/views/groupAuth-group-components-groupDetail"],{16:function(e,t,r){"use strict";function i(e,t,r,i,n,a,o,s){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=r,u._compiled=!0),i&&(u.functional=!0),a&&(u._scopeId="data-v-"+a),o?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},u._ssrRegister=l):n&&(l=s?function(){n.call(this,this.$root.$options.shadowRoot)}:n),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var d=u.beforeCreate;u.beforeCreate=d?[].concat(d,l):[l]}return{exports:e,options:u}}r.d(t,"a",(function(){return i}))},18:function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(t){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?e.exports=i=function(e){return r(e)}:e.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},i(t)}e.exports=i},30:function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"h",(function(){return o})),r.d(t,"m",(function(){return s})),r.d(t,"j",(function(){return l})),r.d(t,"l",(function(){return u})),r.d(t,"n",(function(){return c})),r.d(t,"a",(function(){return d})),r.d(t,"f",(function(){return f})),r.d(t,"k",(function(){return p})),r.d(t,"g",(function(){return m})),r.d(t,"i",(function(){return g})),r.d(t,"c",(function(){return h})),r.d(t,"o",(function(){return b})),r.d(t,"d",(function(){return y}));var i=r(17);function n(){return Object(i.a)({url:"/api/admin/groupType/all",method:"get"})}function a(e){return Object(i.a)({url:"/api/admin/group",method:"post",data:e})}function o(e){return Object(i.a)({url:"/api/admin/group/"+e,method:"get"})}function s(e,t){return Object(i.a)({url:"/api/admin/group/"+e,method:"put",data:t})}function l(e){return Object(i.a)({url:"/api/admin/group/"+e+"/user",method:"get"})}function u(e,t){return Object(i.a)({url:"/api/admin/group/"+e+"/user",method:"put",params:t})}function c(e,t){return Object(i.a)({url:"/api/admin/group/"+e+"/authority/element/remove",method:"delete",params:t})}function d(e,t){return Object(i.a)({url:"/api/admin/group/"+e+"/authority/element/add",method:"post",params:t})}function f(e){return Object(i.a)({url:"/api/admin/group/"+e+"/authority/element",method:"get"})}function p(e,t){return Object(i.a)({url:"/api/admin/group/"+e+"/authority/menu",method:"put",data:t})}function m(e){return Object(i.a)({url:"/api/admin/group/"+e+"/authority/menu",method:"get"})}function g(e){return Object(i.a)({url:"/api/admin/group/role/tree",method:"get"})}function h(e){return Object(i.a)({url:"/api/admin/group/removeNoAudit/"+e,method:"delete"})}function b(e){return Object(i.a)({url:"/api/admin/group/audit",method:"put",data:e})}function y(e){return Object(i.a)({url:"/api/admin/group/enable",method:"put",data:e})}},36:function(e,t,r){"use strict";function i(e){return/^(0|86|17951)?(13[0-9]|15[012356789]|166|17[3678]|18[0-9]|14[57]|171|19[0-9])[0-9]{8}$/.test(e)}function n(e,t,r,i,n){i&&(t||r(new Error(n[0]+"不能为空！"))),t&&(t.length<n[1]||t.length>n[2])?r(new Error(n[0]+"长度在 "+n[1]+" 到 "+n[2]+" 个字符！")):r()}function a(e,t,r,n,a){n&&(t||r(new Error(a[0]+"不能为空！"))),t?i(t)?r():r(new Error(a[0]+"格式错误！")):r()}r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a}))},8:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"handler-container"},[e.groupManagerBtnAdd?r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small",plain:""},on:{click:e.handlerRoot}},[e._v("\n      新增根\n    ")]):e._e(),e._v(" "),e.groupManagerBtnAdd?r("el-button",{attrs:{disabled:e.disabledBranch,type:"primary",icon:"el-icon-circle-plus-outline",size:"small",plain:""},on:{click:e.handlerAdd}},[e._v("新增下级\n    ")]):e._e(),e._v(" "),e.groupManagerBtnEdit?r("el-button",{attrs:{disabled:e.disabledEdit,type:"primary",icon:"el-icon-if-edit",size:"small",plain:""},on:{click:e.handlerEdit}},[e._v("编辑\n    ")]):e._e(),e._v(" "),e.groupManagerBtnDel?r("el-button",{attrs:{disabled:e.disabledDelete,type:"danger",icon:"el-icon-delete",size:"small",plain:""},on:{click:e.handleDelete}},[e._v("删除\n    ")]):e._e(),e._v(" "),r("el-button",{attrs:{disabled:e.disabledAudit,type:"primary",size:"small",icon:"el-icon-if-auth",plain:""},on:{click:function(t){e.clickValidateStatus("form")}}},[e._v("审核\n    ")]),e._v(" "),r("el-button",{attrs:{disabled:e.disabledDisnable,type:"danger",size:"small",icon:"el-icon-circle-close",plain:""},on:{click:function(t){e.clickEnable(2)}}},[e._v("禁用\n    ")]),e._v(" "),r("el-button",{attrs:{disabled:e.disabledEnable,type:"success",size:"small",icon:"el-icon-circle-check",plain:""},on:{click:function(t){e.clickEnable(1)}}},[e._v("启用\n    ")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh",plain:""},on:{click:e.clickRefresh}},[e._v("刷新")])],1),e._v(" "),r("basic-split-pane",{attrs:{"default-percent":20,"min-percent":20}},[r("template",{slot:"leftContainer"},[r("div",{staticClass:"left-container"},[r("el-input",{attrs:{clearable:"",placeholder:"请输入关键字",size:"small"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}},[r("i",{staticClass:"el-icon-search el-input__icon",attrs:{slot:"suffix"},slot:"suffix"})]),e._v(" "),r("el-tree",{ref:"groupTree",staticClass:"filter-tree",attrs:{data:e.treeData,props:e.defaultProps,"filter-node-method":e.filterNode,"default-expand-all":!1,"node-key":"id","highlight-current":""},on:{"node-click":e.getNodeData}})],1)]),e._v(" "),r("template",{slot:"rightContainer"},[r("div",{staticClass:"right-container white"},[r("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[r("el-collapse-item",{attrs:{title:"基本信息",name:"1"}},[r("el-form",{ref:"form",attrs:{"label-position":e.labelPosition,model:e.form,rules:e.rulesGroup,"show-message":!1,"label-width":"80px"}},["update"==e.formStatus?r("el-form-item",[e.groupManagerBtnEdit?r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-if-save",plain:""},on:{click:e.update}},[e._v("保存\n                ")]):e._e(),e._v(" "),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",plain:""},on:{click:e.onCancel}},[e._v("取消")])],1):e._e(),e._v(" "),"create"==e.formStatus?r("el-form-item",[e.groupManagerBtnAdd?r("el-button",{attrs:{size:"small",type:"primary",icon:"el-icon-if-save",plain:""},on:{click:e.create}},[e._v("保存\n                ")]):e._e(),e._v(" "),r("el-button",{attrs:{size:"small",type:"danger",icon:"el-icon-delete",plain:""},on:{click:e.onCancel}},[e._v("取消")])],1):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"类型",prop:"type"}},[r("el-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.dataEnum.roleType,(function(t){return r("el-radio",{key:t.code,attrs:{label:t.code,disabled:e.formEdit}},[e._v("\n                    "+e._s(t.name)+"\n                  ")])})))],1),e._v(" "),r("el-form-item",{attrs:{label:"名称",prop:"name","hide-required-asterisk":""}},[r("el-input",{ref:"refName",attrs:{disabled:e.formEdit,clearable:"",size:"small",placeholder:"请输入名称,最大长度50字符"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"编码",prop:"code"}},[r("el-input",{ref:"refCode",attrs:{disabled:!0,clearable:"",size:"small",placeholder:"自动生成编码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),e._v(" "),r("el-form-item",{staticClass:"add-border disabled",attrs:{label:"审核状态",prop:"validateStatus"}},[r("el-radio-group",{model:{value:e.form.validateStatus,callback:function(t){e.$set(e.form,"validateStatus",t)},expression:"form.validateStatus"}},e._l(e.dataEnum.validateStatus,(function(t){return r("el-radio",{key:t.code,attrs:{label:parseInt(t.code),disabled:""}},[e._v("\n                    "+e._s(t.name)+"\n                  ")])})))],1),e._v(" "),r("el-form-item",{staticClass:"add-border disabled",attrs:{label:"启用状态",prop:"enable"}},[r("el-radio-group",{model:{value:e.form.enable,callback:function(t){e.$set(e.form,"enable",t)},expression:"form.enable"}},e._l(e.dataEnum.enabled,(function(t){return r("el-radio",{key:t.code,attrs:{label:parseInt(t.code),disabled:""}},[e._v("\n                    "+e._s(t.name)+"\n                  ")])})))],1),e._v(" "),r("el-form-item",{attrs:{label:"描述",prop:"description"}},[r("el-input",{attrs:{disabled:e.formEdit,clearable:"",size:"small",placeholder:"请输入描述,最大长度200字符"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1),e._v(" "),e.ifGroupAuthority?r("el-collapse-item",{attrs:{title:"分配权限",name:"2"}},[r("group-authority",{ref:"groupAuthority",attrs:{"group-id":e.currentId,params:e.form}})],1):e._e()],1)],1)])],2),e._v(" "),r("basic-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:e.dialogUserName,visible:e.dialogUserVisible},on:{"update:visible":function(t){e.dialogUserVisible=t}}},[r("group-user",{ref:"groupUser",attrs:{"group-id":e.currentId},on:{closeUserDialog:e.closeUserDialog}})],1),e._v(" "),r("basic-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],attrs:{title:e.dialogAuthorityName,visible:e.dialogAuthorityVisible,size:"large"},on:{"update:visible":function(t){e.dialogAuthorityVisible=t}}},[r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.closeAuthorityDialog}},[e._v("取 消")])],1)])],1)};i._withStripped=!0;var n=r(30),a=r(32),o=r(33),s=r(21),l=r(36),u={name:"GroupDetail",components:{"group-user":function(){return r.e("sysManager/null").then(r.bind(null,9))},"group-authority":function(){return r.e("sysManager/null").then(r.bind(null,11))}},mixins:[a.a,o.a],props:{type:{type:String,default:"1"}},data:function(){return{activeNames:["1","2"],filterText:"",list:null,total:null,formEdit:!0,formAdd:!0,formStatus:"",dialogUserVisible:!1,dialogUserName:"关联用户",dialogAuthorityVisible:!1,dialogAuthorityName:"权限分配",modelSearchFilter:{groupType:this.type,name:void 0},treeData:[],defaultProps:{children:"children",label:"label"},labelPosition:"right",groupManagerBtnEdit:!1,groupManagerBtnDel:!1,groupManagerBtnAdd:!1,groupManagerBtnUserManager:!1,groupManagerBtnResourceManager:!1,form:{type:"1",code:void 0,name:void 0,description:void 0,groupType:this.type,validateStatus:2,enable:1},rulesGroup:{name:[{required:!0,validator:function(e,t,r){Object(l.a)(e,t,r,!0,["名称",1,50])},trigger:"change"}],description:[{validator:function(e,t,r){Object(l.a)(e,t,r,!1,["描述",1,200])},trigger:"change"}]},currentId:-1,groupManagerMenu:!1}},computed:{ifGroupAuthority:function(){return!(!this.$utils.length(this.form)||1!=this.form.validateStatus||2!=this.form.type)},disabledBranch:function(){return!this.$utils.length(this.form)||1!=this.form.validateStatus||1!=this.form.enable||1==this.form.groupType||1!=this.form.type},disabledEdit:function(){return!this.$utils.length(this.form)||1!=this.form.enable||1==this.form.groupType},disabledDelete:function(){return!this.$utils.length(this.form)||"2"!=this.form.validateStatus},disabledAudit:function(){return!this.$utils.length(this.form)||"2"!=this.form.validateStatus||1==this.form.groupType},disabledDisnable:function(){return!this.$utils.length(this.form)||"1"!=this.form.validateStatus||"1"!=this.form.enable||1==this.form.groupType},disabledEnable:function(){return!this.$utils.length(this.form)||"1"!=this.form.validateStatus||"2"!=this.form.enable||1==this.form.groupType}},watch:{filterText:function(e){this.$refs.groupTree.filter(e)}},created:function(){this.getEnumData(["GetValidateStatusData","GetEnabledData","GetRoleTypeData"]),this.getList(!0),this.groupManagerBtnEdit=this.elements["groupManager:btn_edit"],this.groupManagerBtnDel=this.elements["groupManager:btn_del"],this.groupManagerBtnAdd=this.elements["groupManager:btn_add"],this.groupManagerBtnUserManager=this.elements["groupManager:btn_userManager"],this.groupManagerBtnResourceManager=this.elements["groupManager:btn_resourceManager"],this.groupManagerMenu=this.elements["groupManager:menu"]},methods:{clickRefresh:function(){this.resetData(),this.getList(!0)},resetData:function(){var e=this;e.formEdit=!1,e.formStatus="",e.treeData.push({}),e.currentId=-1,e.resetForm(),e.$refs.groupTree.setCurrentKey(null),e.$refs.form.resetFields(),e.$nextTick((function(){e.$refs.groupAuthority&&(e.$refs.groupAuthority.selectData=[])}))},getList:function(e){var t=this;Object(n.i)().then((function(r){t.treeData=r.data,t.$nextTick((function(){t.onCancel(),e&&(t.form.validateStatus=1,t.form={})}))}))},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getNodeData:function(e){var t=this;if(!e.id)return!1;this.formEdit||(this.formStatus="update"),Object(n.h)(e.id).then((function(r){t.form=r.data,t.$refs.form.resetFields(),t.currentId=e.id,e.typeCode==t.dataEnum.roleType[0].code?t.$refs.groupAuthority&&(t.$refs.groupAuthority.selectData=[]):t.$nextTick((function(){t.$refs.groupAuthority&&t.$refs.groupAuthority.initAuthoritys()}))}))},handlerEdit:function(){this.form.id&&(this.formEdit=!1,this.formStatus="update")},handlerRoot:function(){var e=this;e.formEdit=!1,e.formStatus="create",e.treeData.push({}),e.currentId=-1,e.resetForm(),e.$refs.groupTree.setCurrentKey(null),e.$refs.form.resetFields(),e.$nextTick((function(){e.setFocus(),e.$refs.groupAuthority&&(e.$refs.groupAuthority.selectData=[])}))},handlerAdd:function(){var e=this;return-1==this.currentId?(this.$message({message:"请先选择角色！",type:"warning"}),!1):this.form.type==this.dataEnum.roleType[1].code?(this.$message({message:"类型为角色，无法新增下级！",type:"warning"}),!1):(this.resetForm(),this.formEdit=!1,this.formStatus="create",this.$refs.form.resetFields(),e.$refs.groupAuthority.selectData=[],void e.$nextTick((function(){e.setFocus()})))},handleDelete:function(){var e=this;this.$confirm("亲，您是否确定删除当前数据，删除后数据不能恢复！","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(n.c)(e.currentId).then((function(t){e.resetData(),e.getList(!0),e.$message({message:t.message,type:"success",duration:2e3})}))}))},update:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return e.$message({message:s.a.info.updateEmptyError,type:"warning"}),e.setFocus();Object(n.m)(e.form.id,e.form).then((function(t){e.resetData(),e.getList(!0),e.$message({message:t.message,type:"success",duration:2e3})}))}))},setFocus:function(){if(!this.$refs.refName.value)return this.$refs.refName.focus(),!1},create:function(){var e=this;this.$refs.form.validate((function(t){if(t)Object(n.b)(e.form).then((function(t){e.resetData(),e.getList(!0),e.$message({message:t.message,type:"success",duration:2e3})}));else if(e.$message({message:s.a.info.updateEmptyError,type:"warning"}),!e.$refs.refName.value)return e.$refs.refName.focus(),!1}))},onCancel:function(){this.formEdit=!0,this.formStatus="",this.$refs.form.clearValidate()},resetForm:function(){this.form={type:"1",parentId:this.currentId,code:void 0,name:void 0,description:void 0,groupType:this.type,validateStatus:2,enable:1}},handlerUser:function(){this.dialogUserVisible=!0,void 0!==this.$refs.groupUser&&(this.$refs.groupUser.groupId=this.currentId,this.$refs.groupUser.initUsers())},handlerAuthority:function(){this.dialogAuthorityVisible=!0,void 0!==this.$refs.groupAuthority&&(this.$refs.groupAuthority.groupId=this.currentId,this.$refs.groupAuthority.initAuthoritys())},closeUserDialog:function(){this.dialogUserVisible=!1},closeAuthorityDialog:function(){console.log("dialogAuthorityVisible"),this.dialogAuthorityVisible=!1},updateAuthorityDialog:function(){if(this.disabledAudit){var e=this.$refs.groupAuthority.$refs.menuTree.getCheckedKeys();this.$utils.isEmpty(e)?this.$message({message:"亲，请先分配权限！",type:"warning"}):this.$refs.groupAuthority.update()}else this.$message({message:"亲，请先审核数据！",type:"warning"})},clickValidateStatus:function(e){var t=this,r=this;this.$refs[e].validate((function(e){if(e)t.$confirm(s.a.info.audit,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(t.form.id?Object(n.m)(t.form.id,t.form):Object(n.b)(t.form)).then((function(e){200==e.status?r.validateStatusRole(e.data):t.$message({message:e.message,type:"error"})})).catch((function(e){console.log(e)}))}),(function(e){console.log(e)}));else if(t.$message({message:s.a.info.updateEmptyError,type:"warning"}),!t.$refs.refName.value)return t.$refs.refName.focus(),!1}))},validateStatusRole:function(e){var t=this;Object(n.o)(e).then((function(e){200==e.status&&(t.$utils.isEmpty(e.data)||(t.resetData(),t.getList(!0)),t.$message({message:e.message,type:"success"}))})).catch((function(e){console.log(e)}))},clickEnable:function(e){var t=this,r=1==e?s.a.info.enable:s.a.info.disEnable;this.$confirm(r,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var r={id:t.form.id,enable:e};Object(n.d)(r).then((function(r){200==r.status&&(t.form.enable=e,t.$message({type:"success",message:r.message}))})).catch((function(e){console.log(e)}))})).catch((function(){}))}}},c=r(16),d=Object(c.a)(u,i,[],!1,null,null,null);d.options.__file="src/products/sysManager/views/groupAuth/group/components/groupDetail.vue";t.default=d.exports}}]);